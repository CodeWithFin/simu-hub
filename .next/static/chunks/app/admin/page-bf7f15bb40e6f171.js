(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9307:function(e,t,s){Promise.resolve().then(s.bind(s,9725))},9725:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437),r=s(2265),i=s(9376),l=s(7648);function d(){let e=(0,i.useRouter)(),[t,s]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[n,o]=(0,r.useState)([]),[x,h]=(0,r.useState)({status:"",search:""});(0,r.useEffect)(()=>{if(!localStorage.getItem("adminToken")){e.push("/admin/login");return}p()},[e]);let p=async()=>{try{let e=localStorage.getItem("adminToken"),t=await fetch("/api/admin/stats",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&c(s.data)}catch(e){console.error("Failed to load stats:",e)}},m=(0,r.useCallback)(async()=>{s(!0);try{let e=localStorage.getItem("adminToken"),t=new URLSearchParams;x.status&&t.append("status",x.status),x.search&&t.append("search",x.search);let s=await fetch("/api/orders?".concat(t),{headers:{Authorization:"Bearer ".concat(e)}}),a=await s.json();a.success&&o(a.data)}catch(e){console.error("Failed to load orders:",e)}finally{s(!1)}},[x]);(0,r.useEffect)(()=>{m()},[m]);let u=async(e,t)=>{try{let s=localStorage.getItem("adminToken"),a=await fetch("/api/orders/".concat(e,"/status"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({status:t})}),r=await a.json();r.success?(await m(),await p(),"completed"===t?alert("Order marked as complete! Feedback request SMS sent to customer."):alert("Order status updated successfully!")):alert(r.error||"Failed to update order status")}catch(e){alert("Failed to update order status")}},b=e=>{let t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return d?(0,a.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,a.jsx)("nav",{className:"fixed top-0 w-full z-50 bg-black/80 backdrop-blur-md border-b border-white/5",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 md:px-12 h-20 flex items-center justify-between",children:[(0,a.jsxs)(l.default,{href:"/",className:"text-lg font-bold tracking-tighter uppercase font-display group",children:["Simu",(0,a.jsx)("span",{className:"text-beige text-xs align-top ml-1 opacity-80 group-hover:text-white transition-colors",children:"Hub"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("span",{className:"text-sm text-beige",children:"Orders"}),(0,a.jsx)(l.default,{href:"/admin/feedback",className:"text-sm text-gray-400 hover:text-beige transition-colors",children:"Order Feedback"}),(0,a.jsx)(l.default,{href:"/admin/general-feedback",className:"text-sm text-gray-400 hover:text-beige transition-colors",children:"General Feedback"}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("adminToken"),e.push("/admin/login")},className:"border border-white/20 px-4 py-2 text-sm uppercase tracking-wide hover:border-beige hover:text-beige transition-colors",children:"Logout"})]})]})}),(0,a.jsx)("div",{className:"pt-20 pb-20",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 md:px-12",children:[(0,a.jsx)("h1",{className:"font-display text-4xl md:text-5xl uppercase font-bold tracking-tighter mb-12",children:"Admin Dashboard"}),(0,a.jsxs)("section",{className:"mb-12",children:[(0,a.jsx)("h2",{className:"font-display text-xl uppercase font-bold tracking-tight mb-6",children:"Overview"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-offblack p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-xs font-mono text-beige uppercase tracking-wide mb-2",children:"Today's Orders"}),(0,a.jsx)("div",{className:"text-3xl font-display font-bold text-beige mb-2",children:d.today.total}),(0,a.jsxs)("div",{className:"flex gap-4 text-xs text-gray-400",children:[(0,a.jsxs)("span",{children:["Pending: ",d.today.pending]}),(0,a.jsxs)("span",{children:["Completed: ",d.today.completed]})]})]}),(0,a.jsxs)("div",{className:"bg-offblack p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-xs font-mono text-beige uppercase tracking-wide mb-2",children:"This Week"}),(0,a.jsx)("div",{className:"text-3xl font-display font-bold text-beige mb-2",children:d.week.total}),(0,a.jsxs)("div",{className:"flex gap-4 text-xs text-gray-400",children:[(0,a.jsxs)("span",{children:["Pending: ",d.week.pending]}),(0,a.jsxs)("span",{children:["Completed: ",d.week.completed]})]})]}),(0,a.jsxs)("div",{className:"bg-offblack p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-xs font-mono text-beige uppercase tracking-wide mb-2",children:"This Month"}),(0,a.jsx)("div",{className:"text-3xl font-display font-bold text-beige mb-2",children:d.month.total}),(0,a.jsxs)("div",{className:"flex gap-4 text-xs text-gray-400",children:[(0,a.jsxs)("span",{children:["Pending: ",d.month.pending]}),(0,a.jsxs)("span",{children:["Completed: ",d.month.completed]})]})]})]})]}),(0,a.jsx)("section",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("select",{value:x.status,onChange:e=>h({...x,status:e.target.value}),className:"bg-offblack border border-white/10 px-4 py-3 text-white custom-input",children:[(0,a.jsx)("option",{value:"",children:"All Status"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"dispatched",children:"Dispatched"}),(0,a.jsx)("option",{value:"ready",children:"Ready"}),(0,a.jsx)("option",{value:"completed",children:"Completed"})]}),(0,a.jsx)("input",{type:"text",value:x.search,onChange:e=>h({...x,search:e.target.value}),className:"flex-1 bg-offblack border border-white/10 px-4 py-3 text-white placeholder-gray-600 custom-input",placeholder:"Search by order ID, name, or phone..."})]})}),(0,a.jsxs)("section",{className:"bg-offblack border border-white/10",children:[(0,a.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,a.jsx)("h2",{className:"font-display text-xl uppercase font-bold tracking-tight",children:"Orders"})}),t?(0,a.jsx)("div",{className:"flex justify-center py-20",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-beige"})}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-black/50 border-b border-white/10",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Order ID"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Date"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Customer"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Phone"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Product"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Delivery"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Status"}),(0,a.jsx)("th",{className:"p-4 text-left text-xs font-mono text-beige uppercase tracking-wide",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-white/10",children:n.map(e=>{var t,s,r,i;return(0,a.jsxs)("tr",{className:"hover:bg-white/5 transition-colors",children:[(0,a.jsx)("td",{className:"p-4 text-sm",children:e.order_reference}),(0,a.jsx)("td",{className:"p-4 text-sm text-gray-400",children:b(e.created_at)}),(0,a.jsx)("td",{className:"p-4 text-sm",children:(null===(t=e.customers)||void 0===t?void 0:t.name)||"N/A"}),(0,a.jsx)("td",{className:"p-4 text-sm text-gray-400",children:(null===(s=e.customers)||void 0===s?void 0:s.phone)||"N/A"}),(0,a.jsxs)("td",{className:"p-4 text-sm",children:[null===(r=e.products)||void 0===r?void 0:r.brand," ",null===(i=e.products)||void 0===i?void 0:i.model]}),(0,a.jsx)("td",{className:"p-4 text-sm text-gray-400",children:"doorstep"===e.delivery_method?"Doorstep":"Pickup"}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs uppercase tracking-wide ".concat("pending"===e.status?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"completed"===e.status?"bg-beige/20 text-beige border border-beige/30":"bg-white/10 text-white border border-white/20"),children:e.status})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:["pending"===e.status&&(0,a.jsx)("button",{onClick:()=>u(e.id,"doorstep"===e.delivery_method?"dispatched":"ready"),className:"bg-beige text-black px-3 py-1 text-xs font-bold uppercase tracking-wide hover:bg-white transition-colors",children:"doorstep"===e.delivery_method?"Dispatch":"Ready"}),("dispatched"===e.status||"ready"===e.status)&&(0,a.jsx)("button",{onClick:()=>u(e.id,"completed"),className:"bg-beige text-black px-3 py-1 text-xs font-bold uppercase tracking-wide hover:bg-white transition-colors",title:"Mark as complete and send feedback request to customer",children:"Complete"}),"completed"===e.status&&(0,a.jsx)("span",{className:"text-xs text-gray-500 italic px-3 py-1",children:"Feedback requested"})]})})]},e.id)})})]})})]})]})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-beige"})})}},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=9307)}),_N_E=e.O()}]);